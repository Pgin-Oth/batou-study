# Managed by batou: do not edit this file directly. It will be overwritten!

server {
    listen {{component.address.listen}};
    {% if component.address.listen.host_v6 %}
    listen [{{component.address.listen.host_v6}}]:80;
    {% endif %}
    server_name {{component.public_name}} {{component.alias}};

    root {{component.letsencrypt.srv_prj_path}};

    if ($host != {{component.public_name}}) {
        rewrite (.*) http://{{component.public_name}}$1 permanent;
    }
}
{% if component.use_tls %}
server {
    listen {{component.ssl_address.listen}};
    {% if component.ssl_address.listen.host_v6 %}
    listen [{{component.ssl_address.listen.host_v6}}]:443;
    {% endif %}
    server_name {{component.public_name}} {{component.alias}};
}
{% endif %}
